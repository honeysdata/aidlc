# NFR Requirements - Backend API

## 1. 성능 요구사항 (Performance)

### 1.1 응답 시간
| 유형 | 목표 | 측정 기준 |
|------|------|----------|
| 일반 API (CRUD) | 500ms 이내 | 95th percentile |
| 인증 API | 500ms 이내 | 95th percentile |
| SSE 연결 | 2초 이내 | 연결 수립 시간 |
| SSE 이벤트 전달 | 2초 이내 | 이벤트 발생~수신 |

### 1.2 처리량
| 항목 | 목표 |
|------|------|
| 동시 접속자 | 11~50명 |
| 동시 SSE 연결 | 최대 60개 (테이블 10개 + 관리자 50명) |
| 초당 요청 수 | 100 RPS |

### 1.3 데이터베이스
| 항목 | 설정 |
|------|------|
| 연결 풀 크기 | 10~20 연결 |
| 연결 타임아웃 | 30초 |
| 쿼리 타임아웃 | 10초 |

---

## 2. 보안 요구사항 (Security)

### 2.1 인증
| 항목 | 설정 |
|------|------|
| 인증 방식 | JWT (JSON Web Token) |
| 토큰 알고리즘 | HS256 |
| 관리자 토큰 유효기간 | 16시간 |
| 테이블 토큰 유효기간 | 24시간 |

### 2.2 비밀번호
| 항목 | 설정 |
|------|------|
| 해싱 알고리즘 | bcrypt |
| 최소 길이 | 4자 |
| 복잡성 요구사항 | 없음 (MVP) |

### 2.3 CORS
| 항목 | 설정 |
|------|------|
| 허용 출처 | `http://localhost:3000`, `http://localhost:3001` |
| 허용 메서드 | GET, POST, PUT, PATCH, DELETE, OPTIONS |
| 허용 헤더 | Authorization, Content-Type |
| 자격 증명 | 허용 |

### 2.4 데이터 보호
| 항목 | 설정 |
|------|------|
| 비밀번호 저장 | bcrypt 해시 |
| JWT 시크릿 | 환경 변수로 관리 |
| 민감 정보 로깅 | 금지 |

---

## 3. 가용성 요구사항 (Availability)

### 3.1 서비스 가용성
| 항목 | 목표 |
|------|------|
| 가용성 목표 | 99% (MVP) |
| 계획된 다운타임 | 허용 (유지보수) |
| 장애 복구 | 수동 재시작 |

### 3.2 데이터 영속성
| 항목 | 설정 |
|------|------|
| 데이터베이스 | PostgreSQL (단일 인스턴스) |
| 백업 | 수동 (MVP) |
| 복제 | 없음 (MVP) |

---

## 4. 운영 요구사항 (Operability)

### 4.1 로깅
| 항목 | 설정 |
|------|------|
| 로그 레벨 | DEBUG |
| 출력 방식 | 파일 저장 |
| 로그 파일 위치 | `logs/app.log` |
| 로그 포맷 | 타임스탬프, 레벨, 모듈, 메시지 |
| 로그 로테이션 | 일별, 최대 7일 보관 |

### 4.2 로깅 내용
| 유형 | 로깅 여부 |
|------|----------|
| API 요청/응답 | O (DEBUG) |
| 인증 시도 | O (INFO) |
| 에러/예외 | O (ERROR) |
| 비밀번호 | X (금지) |
| JWT 토큰 | X (금지) |

### 4.3 헬스체크
| 항목 | 설정 |
|------|------|
| 엔드포인트 | `GET /health` |
| 체크 항목 | 서버 상태, DB 연결 |
| 응답 형식 | `{"status": "healthy"}` |

---

## 5. 확장성 요구사항 (Scalability)

### 5.1 현재 규모 (MVP)
| 항목 | 규모 |
|------|------|
| 매장 수 | 다중 매장 지원 |
| 매장당 테이블 | 최대 10개 |
| 동시 접속자 | 11~50명 |

### 5.2 확장 고려사항
| 항목 | 현재 | 향후 확장 |
|------|------|----------|
| 서버 | 단일 인스턴스 | 수평 확장 가능 |
| 데이터베이스 | 단일 인스턴스 | 읽기 복제본 |
| SSE | 인메모리 | Redis Pub/Sub |

---

## 6. 테스트 요구사항 (Testability)

### 6.1 테스트 범위
| 유형 | 범위 |
|------|------|
| 단위 테스트 | 서비스 레이어 |
| 통합 테스트 | 제외 (MVP) |
| E2E 테스트 | 제외 (MVP) |

### 6.2 테스트 도구
| 항목 | 도구 |
|------|------|
| 테스트 프레임워크 | pytest |
| 테스트 DB | SQLite (인메모리) |
| 커버리지 | pytest-cov |
